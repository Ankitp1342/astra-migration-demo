{"data":{"edges":[],"nodes":[{"data":{"node":{"template":{"_type":"Component","source":{"tool_mode":false,"trace_as_metadata":true,"list":false,"trace_as_input":true,"required":false,"placeholder":"","show":true,"name":"source","value":"","display_name":"SourceConnection","advanced":false,"input_types":["Data"],"dynamic":false,"info":"The Source Database","title_case":false,"type":"other","_input_type":"DataInput"},"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"# from langflow.field_typing import Data\nfrom langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema import Data\nfrom cassandra.cluster import Cluster\nfrom cassandra.auth import PlainTextAuthProvider\nimport json\n\nclass CustomComponent(Component):\n    display_name = \"LoadHistorical\"\n    description = \"Use as a template to create your own component.\"\n    documentation: str = \"http://docs.langflow.org/components/custom\"\n    icon = \"code\"\n    name = \"CustomComponent\"\n\n    inputs = [\n        \n        \n        DataInput(name=\"source\", display_name=\"SourceConnection\", info=\"The Source Database\"),\n       \n       \n        \n    ]\n\n    outputs = [\n        Output(display_name=\"Output\", name=\"output\", method=\"build_output\"),\n    ]\n\n    def build_output(self) -> list[Data]:\n        \n        \n        \n        source_cluster = Cluster([self.source.data[\"ip\"]])\n        source_session = source_cluster.connect()\n        \n        \n        insert_target = source_session.prepare(\"insert into test.movies (id,content) values (?,?)\")\n        \n        f = open('/usr/local/app/Film.JSON')\n         \n        data = json.load(f)\n        \n        for item in data:\n            source_session.execute(insert_target,[item['Title'],item['Plot']])\n       \n       \n       \n    \n        \n    \n        source_data = Data(\n                data={ \n                    \"Database\": \"Cassandra\",\n                    \"RecordCount\": source_session.execute('SELECT count(*) as ct from test.movies').one().ct,\n                    \n                },\n                \n            )\n    \n\n        return [source_data]\n        \n\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false}},"description":"Use as a template to create your own component.","icon":"code","base_classes":["Data"],"display_name":"Load Historical","documentation":"http://docs.langflow.org/components/custom","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Data"],"selected":"Data","name":"output","display_name":"Output","method":"build_output","value":"__UNDEFINED__","cache":true}],"field_order":["source"],"beta":false,"legacy":false,"edited":true,"metadata":{},"tool_mode":false,"lf_version":"1.1.1","official":false},"type":"CustomComponent","id":"CustomComponent-nw154"},"id":"CustomComponent-nw154","position":{"x":0,"y":0},"type":"genericNode"}],"viewport":{"x":1,"y":1,"zoom":1}},"description":"Use as a template to create your own component.","name":"Load Historical","id":"CustomComponent-nw154","is_component":true,"last_tested_version":"1.1.1"}